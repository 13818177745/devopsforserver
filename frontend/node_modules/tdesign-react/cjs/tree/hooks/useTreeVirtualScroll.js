/**
 * tdesign v1.15.8
 * (c) 2025 tdesign
 * @license MIT
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var hooks_useEventCallback = require('../../hooks/useEventCallback.js');
var hooks_useVirtualScroll = require('../../hooks/useVirtualScroll.js');
require('../../_util/noop.js');
require('../../_chunks/dep-5b506c2b.js');
require('../../_chunks/dep-eb3fc11f.js');
require('../../_chunks/dep-b20c092a.js');
require('../../_chunks/dep-af2a9282.js');
require('../../_chunks/dep-ecfd625d.js');
require('../../_chunks/dep-5253ea18.js');
require('../../_chunks/dep-df62c753.js');
require('../../_chunks/dep-6228dec3.js');
require('../../_chunks/dep-bbe36ea3.js');
require('../../_chunks/dep-bd7ca811.js');
require('../../_chunks/dep-b63856c7.js');
require('../../_chunks/dep-7d270a12.js');
require('../../_chunks/dep-103d03a9.js');
require('../../_chunks/dep-d9be3c5b.js');
require('../../_chunks/dep-5ac0f58d.js');
require('../../_chunks/dep-2306061f.js');
require('../../_chunks/dep-45d27f3b.js');
require('../../_chunks/dep-f0acb1e5.js');
require('../../_chunks/dep-bc320b66.js');
require('../../_chunks/dep-abb2b81c.js');
require('../../_chunks/dep-95d5b3c5.js');
require('../../_chunks/dep-97dc1dd1.js');

function useTreeVirtualScroll(_ref) {
  var treeRef = _ref.treeRef,
    scroll = _ref.scroll,
    _ref$data = _ref.data,
    data = _ref$data === void 0 ? [] : _ref$data,
    onScroll = _ref.onScroll;
  var scrollThreshold = (scroll === null || scroll === void 0 ? void 0 : scroll.threshold) || 100;
  var scrollType = scroll === null || scroll === void 0 ? void 0 : scroll.type;
  var enableVirtual = React.useMemo(function () {
    return scrollType === "virtual";
  }, [scrollType]);
  var isVirtual = React.useMemo(function () {
    return enableVirtual && (data === null || data === void 0 ? void 0 : data.length) > scrollThreshold;
  }, [enableVirtual, scrollThreshold, data]);
  var scrollParams = React.useMemo(function () {
    return {
      type: "virtual",
      isFixedRowHeight: (scroll === null || scroll === void 0 ? void 0 : scroll.isFixedRowHeight) || false,
      rowHeight: (scroll === null || scroll === void 0 ? void 0 : scroll.rowHeight) || 34,
      bufferSize: (scroll === null || scroll === void 0 ? void 0 : scroll.bufferSize) || 20,
      threshold: scrollThreshold
    };
  }, [scroll, scrollThreshold]);
  var _useVirtualScroll = hooks_useVirtualScroll["default"](treeRef, {
      enable: enableVirtual,
      data: data || [],
      scroll: scrollParams
    }),
    _useVirtualScroll$vis = _useVirtualScroll.visibleData,
    visibleData = _useVirtualScroll$vis === void 0 ? null : _useVirtualScroll$vis,
    _useVirtualScroll$han = _useVirtualScroll.handleScroll,
    handleVirtualScroll = _useVirtualScroll$han === void 0 ? null : _useVirtualScroll$han,
    _useVirtualScroll$scr = _useVirtualScroll.scrollHeight,
    scrollHeight = _useVirtualScroll$scr === void 0 ? null : _useVirtualScroll$scr,
    _useVirtualScroll$tra = _useVirtualScroll.translateY,
    translateY = _useVirtualScroll$tra === void 0 ? null : _useVirtualScroll$tra,
    _useVirtualScroll$han2 = _useVirtualScroll.handleRowMounted,
    handleRowMounted = _useVirtualScroll$han2 === void 0 ? null : _useVirtualScroll$han2,
    scrollToElement = _useVirtualScroll.scrollToElement;
  var lastScrollY = -1;
  var onInnerVirtualScroll = hooks_useEventCallback["default"](function (e) {
    onScroll === null || onScroll === void 0 || onScroll({
      e: e
    });
    if (!isVirtual) {
      return;
    }
    var target = e.target;
    var top = target.scrollTop;
    if (lastScrollY !== top) {
      handleVirtualScroll();
    } else {
      lastScrollY = -1;
    }
    lastScrollY = top;
  });
  React.useEffect(function () {
    var _treeList$addEventLis;
    var treeList = treeRef === null || treeRef === void 0 ? void 0 : treeRef.current;
    treeList === null || treeList === void 0 || (_treeList$addEventLis = treeList.addEventListener) === null || _treeList$addEventLis === void 0 || _treeList$addEventLis.call(treeList, "scroll", onInnerVirtualScroll);
    return function () {
      var _treeList$removeEvent;
      treeList === null || treeList === void 0 || (_treeList$removeEvent = treeList.removeEventListener) === null || _treeList$removeEvent === void 0 || _treeList$removeEvent.call(treeList, "scroll", onInnerVirtualScroll);
    };
  }, [treeRef, onInnerVirtualScroll]);
  var cursorStyle = {
    position: "absolute",
    width: "1px",
    height: "1px",
    transition: "transform 0.2s",
    transform: "translate(0, ".concat(scrollHeight, "px)"),
    MsTransform: "translate(0, ".concat(scrollHeight, "px)"),
    MozTransform: "translate(0, ".concat(scrollHeight, "px)"),
    WebkitTransform: "translate(0, ".concat(scrollHeight, "px)")
  };
  var treeNodeStyle = {
    transform: "translate(0, ".concat(translateY, "px)"),
    MsTransform: "translate(0, ".concat(translateY, "px)"),
    MozTransform: "translate(0, ".concat(translateY, "px)"),
    WebkitTransform: "translate(0, ".concat(translateY, "px)")
  };
  return {
    scrollHeight: scrollHeight,
    translateY: translateY,
    visibleData: visibleData,
    handleRowMounted: handleRowMounted,
    isVirtual: isVirtual,
    cursorStyle: cursorStyle,
    treeNodeStyle: treeNodeStyle,
    scrollToElement: scrollToElement
  };
}

exports["default"] = useTreeVirtualScroll;
//# sourceMappingURL=useTreeVirtualScroll.js.map
