{"version":3,"file":"index.js","sources":["../../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseHas.js","../../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/has.js","../../../../components/form/utils/index.ts"],"sourcesContent":["/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.has` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHas(object, key) {\n  return object != null && hasOwnProperty.call(object, key);\n}\n\nexport default baseHas;\n","import baseHas from './_baseHas.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct property of `object`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = { 'a': { 'b': 2 } };\n * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.has(object, 'a');\n * // => true\n *\n * _.has(object, 'a.b');\n * // => true\n *\n * _.has(object, ['a', 'b']);\n * // => true\n *\n * _.has(other, 'a');\n * // => false\n */\nfunction has(object, path) {\n  return object != null && hasPath(object, path, baseHas);\n}\n\nexport default has;\n","import { get, has, isArray, isEmpty, isObject } from 'lodash-es';\nimport type { FormItemInstance } from '../FormItem';\nimport type { NamePath } from '../type';\n\n/**\n * 在 `formMap` 中查找指定的 `FormItem`\n * (仅查找当前层级)\n */\nexport function findFormItem(\n  name: NamePath,\n  formMapRef: React.MutableRefObject<Map<any, any>>,\n): React.RefObject<FormItemInstance> | undefined {\n  if (!formMapRef.current) return;\n  // 提取所有 map key\n  const mapKeys = [...formMapRef.current.keys()];\n  // 转译为字符串后比对 key 兼容数组格式\n  const key = mapKeys.find((key) => String(key) === String(name));\n  // 拿到 key 引用地址获取 value\n  return formMapRef.current.get(key);\n}\n\n/**\n * 在 `formMap` 中查找指定的 `FormItem`\n * (包括在嵌套的 FormList 中递归查找）\n */\nexport function findFormItemDeep(\n  name: NamePath,\n  formMapRef: React.MutableRefObject<Map<any, any>>,\n): React.RefObject<FormItemInstance> | undefined {\n  if (!formMapRef?.current) return;\n  const targetPath = Array.isArray(name) ? name : [name];\n  for (const [key, ref] of formMapRef.current.entries()) {\n    const formItem = ref?.current;\n    if (!formItem?.isFormList || !formItem.formListMapRef) continue;\n    const { formListMapRef } = formItem;\n    for (const [itemKey, itemRef] of formListMapRef.current.entries()) {\n      const fullPath = [key, itemKey].flat();\n      if (String(fullPath) === String(targetPath)) return itemRef;\n    }\n    const found = findFormItemDeep(name, formListMapRef);\n    if (found) return found;\n  }\n}\n\n// { user: { name: '' } } => [['user', 'name']]\n// 不处理数组类型\n// { user: [{ name: '' }]} => [['user']]\nexport function objectToArray(obj: Record<string | number, any>) {\n  const result: (string | number)[][] = [];\n\n  function traverse(current: any, path: string[] = []) {\n    if (isObject(current) && !isArray(current) && !isEmpty(current)) {\n      Object.keys(current).forEach((key) => {\n        traverse(current[key], [...path, key]);\n      });\n    } else {\n      result.push(path);\n    }\n  }\n\n  traverse(obj);\n  return result;\n}\n\n// 将数据整理成对象，数组 name 转化嵌套对象: ['user', 'name'] => { user: { name: '' } }\nexport function calcFieldValue(name: NamePath, value: any, isFormList = true) {\n  if (Array.isArray(name)) {\n    if (isFormList) {\n      const fieldValue = name.reduceRight((prev, curr) => {\n        const arr = [];\n        if (/^\\d+$/.test(String(curr))) arr[curr] = prev;\n        return arr.length ? arr : { [curr]: prev };\n      }, value);\n      return { ...fieldValue };\n    }\n    return name.reduceRight((prev, curr, currentIndex) => {\n      if (currentIndex === name.length - 1) {\n        return { [curr]: value };\n      }\n      return { [curr]: prev };\n    }, {});\n  }\n\n  return { [name]: value };\n}\n\n// 通过对象数据类型获取 map 引用: { user: { name: '' } } => formMap.get(['user', 'name'])\nexport function travelMapFromObject(\n  obj: Record<any, any>,\n  formMapRef: React.MutableRefObject<Map<any, any>>,\n  callback: Function,\n) {\n  for (const [mapName, formItemRef] of formMapRef.current.entries()) {\n    if (has(obj, mapName)) {\n      callback(formItemRef, get(obj, mapName));\n    }\n  }\n}\n"],"names":["objectProto","Object","prototype","hasOwnProperty","baseHas","object","key","call","has","path","hasPath","findFormItem","name","formMapRef","current","mapKeys","keys","find","String","get","findFormItemDeep","targetPath","Array","isArray","_iterator","_createForOfIteratorHelper","entries","_step","s","n","done","_step$value","_slicedToArray","value","ref","formItem","isFormList","formListMapRef","_iterator2","_step2","_step2$value","itemKey","itemRef","fullPath","flat","err","e","f","found","objectToArray","obj","result","traverse","arguments","length","undefined","isObject","isEmpty","forEach","concat","_toConsumableArray","push","calcFieldValue","fieldValue","reduceRight","prev","curr","arr","test","_defineProperty","_objectSpread","currentIndex","travelMapFromObject","callback","_iterator3","_step3","_step3$value","mapName","formItemRef"],"mappings":"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"}